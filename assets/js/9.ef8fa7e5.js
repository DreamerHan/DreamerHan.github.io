(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{398:function(t,s,a){t.exports=a.p+"assets/img/log4js1.81d50658.png"},399:function(t,s,a){t.exports=a.p+"assets/img/log4js2.7716f2ab.png"},400:function(t,s,a){t.exports=a.p+"assets/img/log4js3.30402b54.png"},401:function(t,s,a){t.exports=a.p+"assets/img/log4js4.72c18e82.png"},533:function(t,s,a){"use strict";a.r(s);var n=a(54),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"log4js"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#log4js"}},[t._v("#")]),t._v(" Log4js")]),t._v(" "),n("h2",{attrs:{id:"node-日志工具"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node-日志工具"}},[t._v("#")]),t._v(" node 日志工具")]),t._v(" "),n("p",[n("code",[t._v("log4js")]),t._v(" 是一种 node 日志管理工具，可以将自定义格式的日志输出到各种渠道。")]),t._v(" "),n("p",[t._v("对于控制台的日志输出可以呈现彩色日志，对于文件方式的日志输出，可以根据文件大小或者日期进行日志切割。")]),t._v(" "),n("h2",{attrs:{id:"基础用法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#基础用法"}},[t._v("#")]),t._v(" 基础用法")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" log4js "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"log4js"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 引入依赖")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" logger "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" log4js"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLogger")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取 logger 实例")]),t._v("\n\nlogger"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("level "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"info"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 定义日志级别，默认是 OFF - 关闭所有的日志")]),t._v("\n\nlogger"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"I am a info msg"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 调用对应日志级别方法输出日志")]),t._v("\n")])])]),n("h4",{attrs:{id:"默认值说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#默认值说明"}},[t._v("#")]),t._v(" 默认值说明")]),t._v(" "),n("ol",[n("li",[t._v("通过打印 "),n("code",[t._v("logger")]),t._v(" 可以查看默认配置如下：")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("Logger "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  category"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'default'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 注意这里")]),t._v("\n  context"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  callStackSkipIndex"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  parseCallStack"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" defaultParseCallStack"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("ol",{attrs:{start:"2"}},[n("li",[t._v("查看 "),n("code",[t._v("logger.level")]),t._v(" 配置如下：")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("Level "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  level"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.7976931348623157e+308")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  levelStr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'OFF'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 默认是 OFF 关闭日志，所以如果不设置 level 的话，是不会打印日志的")]),t._v("\n  colour"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'grey'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h4",{attrs:{id:"基础用法日志信息如下"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#基础用法日志信息如下"}},[t._v("#")]),t._v(" 基础用法日志信息如下")]),t._v(" "),n("p",[n("img",{attrs:{src:a(398),alt:"An image"}})]),t._v(" "),n("h2",{attrs:{id:"几个概念"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#几个概念"}},[t._v("#")]),t._v(" 几个概念")]),t._v(" "),n("h3",{attrs:{id:"level"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#level"}},[t._v("#")]),t._v(" Level")]),t._v(" "),n("p",[n("strong",[t._v("日志级别")]),t._v(" 划分日志不同等级的类型，侧重于一条日志的重要性。")]),t._v(" "),n("p",[t._v("例如 console 打印日志，有普通的 "),n("code",[t._v("console.log")]),t._v(", 也有错误类型的 "),n("code",[t._v("console.error")]),t._v("，也有警告类型 "),n("code",[t._v("console.warn")]),t._v("。")]),t._v(" "),n("p",[t._v("日志分级能更好的管理日志的输出形式，比如 error 类型的就是 红色展示。")]),t._v(" "),n("p",[t._v("另外，日志的等级设置可以快速的过滤掉一些在生产环境不需要记录的日志信息。比如在开发时，使用 "),n("code",[t._v("logger.debug")]),t._v(" 打印 debug 级别的日志，上线后使用 "),n("code",[t._v("info")]),t._v(" 级别的日志后。debug 的就不再输出，"),n("strong",[t._v("因为日志只输出和当前设置级别相同或更高的日志")]),t._v("。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(399),alt:"An image"}})]),t._v(" "),n("p",[t._v("默认级别数，重置 level 时可以作为参考。如果担心有更新，可以通过 "),n("code",[t._v("log4js.levels")]),t._v(" 查看。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ALL")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Level")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Number"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("MIN_VALUE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ALL"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("TRACE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Level")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TRACE"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DEBUG")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Level")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"DEBUG"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INFO")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Level")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"INFO"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("WARN")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Level")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("30000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WARN"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ERROR")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Level")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("40000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ERROR"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("FATAL")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Level")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("50000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"FATAL"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("MARK")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Level")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9007199254740992")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"MARK"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2^53")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("OFF")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Level")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Number"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("MAX_VALUE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"OFF"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h3",{attrs:{id:"category"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#category"}},[t._v("#")]),t._v(" Category")]),t._v(" "),n("p",[n("strong",[t._v("日志分类")]),t._v(" 和日志级别 "),n("code",[t._v("level")]),t._v(" 的作用都是用来区分日志的类型的。category 可以理解成更大维度的区分信息。")]),t._v(" "),n("h4",{attrs:{id:"应用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#应用"}},[t._v("#")]),t._v(" 应用")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" log4js "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"log4js"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// getLogger 函数接受唯一一个参数就是 category 分类名称")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" logger "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" log4js"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLogger")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"res-model"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nlogger"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("level "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"info"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 默认是 OFF - 关闭所有的日志")]),t._v("\n\nlogger"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"I am a res-model category log"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[n("img",{attrs:{src:a(400),alt:"An image"}})]),t._v(" "),n("h3",{attrs:{id:"appenders"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#appenders"}},[t._v("#")]),t._v(" Appenders")]),t._v(" "),n("p",[n("code",[t._v("level")]),t._v(" 和 "),n("code",[t._v("category")]),t._v(" 解决了日志级别和分类的问题，日志最基础的模样已经有了。接下来就是日志输出到哪里的问题了。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// appender 的默认配置是将所有日志事件写入到标准输出流(standard output stream)中")]),t._v("\ndefaultConfigs "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  appenders"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" type"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stdout"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("appenders 中的常见 type 有哪些？")]),t._v(" "),n("ol",[n("li",[n("strong",[t._v("conosle")]),t._v("、"),n("strong",[t._v("stdout")]),t._v("、"),n("strong",[t._v("stderr")]),t._v(" 这三个都是输出到控制台的，个人理解是开发时使用的模式")]),t._v(" "),n("li",[n("strong",[t._v("file")]),t._v(" 输出到指定的文件中，type 指定为 file 时还有更多配置，见下文")]),t._v(" "),n("li",[n("strong",[t._v("fileSync")]),t._v(" 同步文件 appender，和标准文件 appender 相比，区别在于所以写入都是同步的。而且不像异步版本，不支持对备份文件进行压缩。")]),t._v(" "),n("li",[n("strong",[t._v("dateFile")]),t._v(" 按日期滚动的文件。它的行为类似于一开始会创建一个你定义的 filename 文件名，比如是 test.log。过了一天之后，备份出一个 test.log.xxxx-xx-xx 形式的文件，然后重新创建出一个新的 test.log 文件。")])])]),t._v(" "),n("p",[n("code",[t._v("appenders")]),t._v(" 一直都是 log4js 的配置中设置的，示例后面一起看。")]),t._v(" "),n("h2",{attrs:{id:"重点-api"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#重点-api"}},[t._v("#")]),t._v(" 重点 API")]),t._v(" "),n("h3",{attrs:{id:"configure"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#configure"}},[t._v("#")]),t._v(" configure")]),t._v(" "),n("p",[n("strong",[t._v("应用方式："),n("code",[t._v("log4js.configure(string || object)")])])]),t._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("参数说明")]),t._v(" "),n("p",[n("strong",[t._v("string")]),t._v(" 如果参数为 string 类型，则被当做为配置文件路径，则该配置文件必须为 JSON 文件。")]),t._v(" "),n("p",[n("strong",[t._v("object")]),t._v(" 如果参数一个配置对象，则至少要定义一个 appender 和默认的 category。")])]),t._v(" "),n("p",[n("strong",[n("font",{attrs:{size:"4"}},[t._v("configure 如果要设置一个 object，具体参数如下：")])],1)]),t._v(" "),n("p",[n("strong",[n("font",{attrs:{size:"4",color:"#42b983"}},[t._v("1. levels（object）")])],1)]),t._v(" "),n("ul",[n("li",[t._v("非必填")]),t._v(" "),n("li",[t._v("该属性用来自定义日志的 level，或者重新定义已存在的 level。")]),t._v(" "),n("li",[n("code",[t._v("json")]),t._v(" 形式，key 作为 level 名称；value 是 object，有两个属性："),n("code",[t._v("value(integer)")]),t._v(" 用来确认顺序 和 "),n("code",[t._v("colour")]),t._v(" 用来设置颜色")]),t._v(" "),n("li",[t._v("该参数可以配置额外的 level。但是如果配置的名称恰好与默认 level 名称一致，则直接覆盖掉默认的 value 值。")]),t._v(" "),n("li",[t._v("level 名称必须以字母开头，只能包含字母、数字、下划线")])]),t._v(" "),n("p",[n("strong",[n("font",{attrs:{size:"4",color:"#42b983"}},[t._v("2. appenders（object）")])],1)]),t._v(" "),n("ul",[n("li",[n("code",[t._v("object.key")]),t._v(" 是自定义的 appender 名称，对应的 value 值是一个对象")]),t._v(" "),n("li",[t._v("value 对象中必须包含 "),n("code",[t._v("type")]),t._v(" 属性，它就是指明用那种方式输出日志，上面有记录常用的 console、file、dateFile...")]),t._v(" "),n("li",[t._v("搭配着对应的 type 属性，还有更多细节的属性，比如"),n("code",[t._v("type: file")]),t._v(" 时，后面需要设置 filename，即文件输出的路径或着文件名。")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("log4js"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("configure")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  appenders"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    stdout"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" type"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stdout"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    stderr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" type"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stderr"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" type"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"console"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    file"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" type"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"file"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test-file.log"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[n("strong",[n("font",{attrs:{size:"4",color:"#42b983"}},[t._v("3. categories（object）")])],1)]),t._v(" "),n("ul",[n("li",[t._v("配置好了 "),n("code",[t._v("appenders")]),t._v("，确认了日志往哪里输出后，就可以确认哪种分类的日志，使用哪种输出方式。"),n("strong",[t._v("所以，需要在 categories 中配置 appenders 的 key。")])]),t._v(" "),n("li",[n("strong",[t._v("object.key")]),t._v(" 时自定义的 category 名称，对应的 value 值是一个对象。")]),t._v(" "),n("li",[n("strong",[t._v("value 对象参数 1")]),t._v(": "),n("code",[t._v("appenders")]),t._v(", 它是一个数组，里面是 appenders 中配置的 key 名。")]),t._v(" "),n("li",[n("strong",[t._v("value 对象参数 2")]),t._v(": "),n("code",[t._v("level")]),t._v(", 指定发送到 appender 的最小 level。例如，如果设置为'error'，则 appender 只能接收到‘error’, ‘fatal’, ‘mark’级别的消息，‘info’, ‘warn’, ‘debug’, or ‘trace’ 会被忽略掉。")]),t._v(" "),n("li",[n("font",{attrs:{color:"red"}},[n("strong",[t._v("重点的是：必须要有一个 key 是 default 的配置，")])]),t._v("在所有日志事件没有匹配到指定的 category 时使用该默认值")],1)]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" log4js "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"log4js"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nlog4js"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("configure")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  appenders"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    stdout"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" type"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stdout"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    stderr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" type"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stderr"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" type"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"console"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    file"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" type"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"file"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"logs/test-file.log"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将在同级目录下创建 logs 文件夹同时创建 test-file.log 文件")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  categories"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" appenders"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stdout"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" level"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"debug"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    test"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" appenders"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stdout"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" level"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"debug"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    file"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" appenders"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"file"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" level"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"info"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" logger "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" log4js"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLogger")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nlogger"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("level "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"info"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这里可以重新调整 level 级别")]),t._v("\n\nlogger"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"日志输出"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("疑惑点")]),t._v(" "),n("p",[t._v("这里发现的一个让我自己很困惑的点，如上面的代码配置后。")]),t._v(" "),n("p",[t._v("虽然在使用 getLogger 方法获取 logger 实例时我已经设置了参数是 "),n("code",[t._v("test")]),t._v("。")]),t._v(" "),n("p",[t._v("当然此时的本意是我只使用 test 的类别，别的类别可能处于被我放弃的情况。")]),t._v(" "),n("p",[t._v("但是当执行程序时，会同时为 categories 下的 file 创建一个在 appenders 中设置的文件名称 logs/test-file.log")]),t._v(" "),n("p",[t._v("但是如果 categories 下没有 file 这个配置，就不会发生这种问题。")]),t._v(" "),n("p",[n("strong",[n("font",{attrs:{color:"red"}},[t._v("所以，个人理解不要在 categories 中设置多余的配置，最好是精准配置。避免多处额外不必要的文件影响项目架构。")])],1)])]),t._v(" "),n("p",[n("strong",[n("font",{attrs:{size:"4",color:"#42b983"}},[t._v("4. pm2（boolean）")])],1)]),t._v(" "),n("ul",[n("li",[t._v("非必填")]),t._v(" "),n("li",[t._v("当使用 pm2 时候，需要设置该值为 true，否则无法正常运行日志")]),t._v(" "),n("li",[t._v("您还需要将 pm2-intercom 安装为 pm2 模块：pm2 install pm2-intercom")])]),t._v(" "),n("p",[n("strong",[n("font",{attrs:{size:"4",color:"#42b983"}},[t._v("5. pm2InstanceVar（string）")])],1)]),t._v(" "),n("ul",[n("li",[t._v("非必填")]),t._v(" "),n("li",[t._v("默认值是 "),n("strong",[t._v("NODE_APP_INSTANCE")])]),t._v(" "),n("li",[t._v("当使用 pm2 且更改了 NODE_APP_INSTANCE 默认值时，需要对应设置该属性。")])]),t._v(" "),n("p",[n("strong",[n("font",{attrs:{size:"4",color:"#42b983"}},[t._v("6. disableClustering（boolean）")])],1)]),t._v(" "),n("ul",[n("li",[t._v("非必填")]),t._v(" "),n("li",[t._v("如果您喜欢 log4js 过去忽略集群环境的方式，或者您在 PM2 日志记录方面遇到问题，请将此设置为 true。 每个工作进程都将执行自己的日志记录。 如果您正在记录文件，请小心这一点，可能会发生奇怪的事情。")])]),t._v(" "),n("h3",{attrs:{id:"loggers"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#loggers"}},[t._v("#")]),t._v(" Loggers")]),t._v(" "),n("p",[n("strong",[t._v("获取方式："),n("code",[t._v("log4js.getLogger([category])")])])]),t._v(" "),n("p",[t._v("返回一个 Logger 对象，该对象使用指定的 category，如果未指定 category 参数，则使用默认的 category。")]),t._v(" "),n("p",[n("strong",[n("font",{attrs:{size:"4"}},[t._v("Logger 对象实现了以下方法:")])],1)]),t._v(" "),n("p",[n("strong",[n("font",{attrs:{size:"4",color:"#42b983"}},[t._v("1. .level(args…)")])],1)]),t._v(" "),n("p",[t._v("可以使任何小写的 level 名称(包含自定义的 level)。例如:logger.info('some info')会发送一个 info 级别的 log event。")]),t._v(" "),n("p",[n("strong",[n("font",{attrs:{size:"4",color:"#42b983"}},[t._v("2. is[level]Enabled()")])],1)]),t._v(" "),n("ul",[n("li",[t._v("返回布尔值，检测是否会发送指定的 level 的日志事件。")]),t._v(" "),n("li",[t._v("例如，当前 category 指定的 level 为 INFO 或者更低，则 "),n("code",[t._v("logger.isInfoEnabled()")]),t._v(" 返回 true。")])]),t._v(" "),n("p",[n("strong",[n("font",{attrs:{size:"4",color:"#42b983"}},[t._v("3. addContext(key, value)")])],1)]),t._v(" "),n("ul",[n("li",[t._v("key 为 string 类型，value 可以为任何类型。")]),t._v(" "),n("li",[t._v("该键值对会被添加到所有日志事件中，例如可以添加相关 id，用来追踪应用中一个用户的所有日志。")]),t._v(" "),n("li",[t._v("目前只在 logFaceappender 中使用了 context 值。")])]),t._v(" "),n("p",[n("strong",[n("font",{attrs:{size:"4",color:"#42b983"}},[t._v("4. removeContext(key)")])],1)]),t._v(" "),n("ul",[n("li",[t._v("删除指定的 context。")])]),t._v(" "),n("p",[n("strong",[n("font",{attrs:{size:"4",color:"#42b983"}},[t._v("5. clearContext()")])],1)]),t._v(" "),n("ul",[n("li",[t._v("清除所有 context 键值对。")])]),t._v(" "),n("p",[n("strong",[n("font",{attrs:{size:"4",color:"#42b983"}},[t._v("6. level")])],1),t._v("\n当前 level 值，可以通过更改该值从而重写原本的 level 值。")]),t._v(" "),n("h3",{attrs:{id:"shutdown"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#shutdown"}},[t._v("#")]),t._v(" Shutdown")]),t._v(" "),n("p",[n("strong",[t._v("获取方式："),n("code",[t._v("log4js.shutdown(cb)")])])]),t._v(" "),n("p",[t._v("当 log4js 关闭所有 appender 以及所有日志事件都完成写入时，会调用传入的回调函数。\n在程序退出时使用该方法，可以保证所有文件写入,socket 都已关闭，等等。")]),t._v(" "),n("h3",{attrs:{id:"custom-layouts"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#custom-layouts"}},[t._v("#")]),t._v(" Custom Layouts")]),t._v(" "),n("p",[n("strong",[t._v("获取方式："),n("code",[t._v("log4js.addLayout(type, fn)")])])]),t._v(" "),n("p",[t._v("添加自定义的 layout 函数。详细查看:"),n("a",{attrs:{href:"https://log4js-node.github.io/log4js-node/layouts.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("layouts"),n("OutboundLink")],1)]),t._v(" "),n("h2",{attrs:{id:"appender-配置示例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#appender-配置示例"}},[t._v("#")]),t._v(" Appender 配置示例")]),t._v(" "),n("h3",{attrs:{id:"file-appender"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#file-appender"}},[t._v("#")]),t._v(" File Appender")]),t._v(" "),n("p",[t._v("将日志事件写入到文件。当使用文件 appender 时，需要在应用终止时，调用 log4js.shutdown 以保证完成剩余的异步操作。")]),t._v(" "),n("p",[t._v("文件 appender 使用的是 streamroller 库。")]),t._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("配置参数")]),t._v(" "),n("ul",[n("li",[t._v('type - "file"')]),t._v(" "),n("li",[t._v("filename - string - 文件路径。")]),t._v(" "),n("li",[t._v("maxLogSize - integer (optional) - 限制文件的大小，单位为 byte。如果超出该值则会备份原文件创建新文件。")]),t._v(" "),n("li",[t._v("backups - integer (optional, default value = 5) - 备份文件的最大数量。")]),t._v(" "),n("li",[t._v("layout - (optional, defaults to basic layout) - see layouts")])]),t._v(" "),n("p",[t._v("剩余其他额外的参数，会被传递给底层的 "),n("a",{attrs:{href:"https://github.com/log4js-node/streamroller",target:"_blank",rel:"noopener noreferrer"}},[t._v("streamroller"),n("OutboundLink")],1),t._v(" (参数含义也可查看 node.js core file streams)：")]),t._v(" "),n("ul",[n("li",[t._v("encoding - string (default “utf-8”)")]),t._v(" "),n("li",[t._v("mode- integer (default 0644)")]),t._v(" "),n("li",[t._v("flags - string (default ‘a’)")]),t._v(" "),n("li",[t._v("compress - boolean (default false) - 在滚动期间压缩备份文件（备份文件将具有 .gz 扩展名）")]),t._v(" "),n("li",[t._v("keepFileExt - boolean (default false) - 更新日志文件时保留文件扩展名（file.log 变为 file.1.log 而不是 file.log.1）")])])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("log4js"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("configure")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  appenders"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    everything"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" type"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"file"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"all-the-logs.log"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  categories"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" appenders"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"everything"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" level"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"debug"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" logger "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" log4js"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLogger")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nlogger"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("debug")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"I will be logged in all-the-logs.log"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("配置上文件滚动和压缩以及备份文件个数时：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("log4js"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("configure")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  appenders"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    everything"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      type"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"file"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"all-the-logs.log"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      maxLogSize"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10485760")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      backups"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      compress"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  categories"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" appenders"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"everything"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" level"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"debug"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("上述代码会产生一个当前的日志文件(all-the-logs.log)。当该文件达到 10Mb 时，会压缩并命名为:all-the-logs.log.1.gz ，并创建一个新文件命名为 all-the-logs.log 。")]),t._v(" "),n("p",[t._v("当 all-the-logs.log 再次达到 10Mb 时，原 all-the-logs.log.1.gz 会被改名为 all-the-logs.log.2.gz，以此类推。")]),t._v(" "),n("h3",{attrs:{id:"datefile-appender"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#datefile-appender"}},[t._v("#")]),t._v(" dateFile Appender")]),t._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("配置参数")]),t._v(" "),n("ul",[n("li",[t._v("filename string 文件路径及文件名，./为项目根目录")]),t._v(" "),n("li",[t._v("pattern? string 滚动日志的时间类型，默认为 .yyyy-MM-dd")]),t._v(" "),n("li",[t._v("encoding? string 编码格式，默认为 utf-8")]),t._v(" "),n("li",[t._v("compress? boolean 是否压缩滚动日志文件")]),t._v(" "),n("li",[t._v("daysToKeep? number 如果此值大于零，则日志滚动期间将删除早于该天数的文件，默认为 0")]),t._v(" "),n("li",[t._v("alwaysIncludePattern? boolean 在当前日志文件名中和滚动日志一样包括 pattern")]),t._v(" "),n("li",[t._v("layout? Layout 输出的样式")])])]),t._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("pattern")]),t._v(" "),n("p",[t._v("pattern 是保存滚动日志的时间分割，规则如下：")]),t._v(" "),n("ul",[n("li",[t._v("yyyy : 年")]),t._v(" "),n("li",[t._v("MM : 月")]),t._v(" "),n("li",[t._v("dd : 日")]),t._v(" "),n("li",[t._v("hh : 时")]),t._v(" "),n("li",[t._v("mm : 分")]),t._v(" "),n("li",[t._v("ss : 秒")]),t._v(" "),n("li",[t._v("SSS : 毫秒")])])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置成这样，会每秒都保存滚动日志文件，若当前秒没有日志，则不保存。")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 文件名格式基本统一为：文件名.年-月-日 时:分:秒")]),t._v("\npattern"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".yyyy-MM-dd hh:mm:ss"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[n("img",{attrs:{src:a(401),alt:"An image"}})]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" log4js "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"log4js"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nlog4js"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("configure")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  appenders"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    dateFileOut"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      type"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dateFile"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"datefile.log"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      pattern"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".yyyy-MM-dd hh:mm:ss"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      maxLogSize"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n  categories"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" appenders"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" level"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"debug"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    dataFileLog"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" appenders"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dateFileOut"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" level"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"debug"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" logger "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" log4js"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLogger")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dataFileLog"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nlogger"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("debug")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"日志输出"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);