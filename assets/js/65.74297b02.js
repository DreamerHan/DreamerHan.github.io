(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{520:function(s,a,n){"use strict";n.r(a);var t=n(54),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"crontab-拆分日志"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#crontab-拆分日志"}},[s._v("#")]),s._v(" crontab 拆分日志")]),s._v(" "),n("h2",{attrs:{id:"基础"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#基础"}},[s._v("#")]),s._v(" 基础")]),s._v(" "),n("p",[s._v("crontab 是一个 linux 命令，一个定时任务")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("crontab -e")]),s._v(" 开启设置 crontab 任务的文本面板")]),s._v(" "),n("li",[n("code",[s._v("crontab -l")]),s._v(" 查询已经设置的 crontab 任务命令")])]),s._v(" "),n("p",[s._v("设置定时任务格式是 "),n("code",[s._v("***** command")])]),s._v(" "),n("ul",[n("li",[s._v("第一个 "),n("code",[s._v("*")]),s._v(" 表示 "),n("code",[s._v("分钟")]),s._v("，写成 "),n("code",[s._v("*")]),s._v(" 表示忽略")]),s._v(" "),n("li",[s._v("第二个 "),n("code",[s._v("*")]),s._v(" 表示 "),n("code",[s._v("小时")]),s._v("，写成 "),n("code",[s._v("*")]),s._v(" 表示忽略")]),s._v(" "),n("li",[s._v("第三个 "),n("code",[s._v("*")]),s._v(" 表示 "),n("code",[s._v("日期（几号）")]),s._v("，写成 "),n("code",[s._v("*")]),s._v(" 表示忽略")]),s._v(" "),n("li",[s._v("第四个 "),n("code",[s._v("*")]),s._v(" 表示 "),n("code",[s._v("月份")]),s._v("，写成 "),n("code",[s._v("*")]),s._v(" 表示忽略")]),s._v(" "),n("li",[s._v("第五个 "),n("code",[s._v("*")]),s._v(" 表示 "),n("code",[s._v("星期")]),s._v("，写成 "),n("code",[s._v("*")]),s._v(" 表示忽略")])]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 表示每1分钟执行一次 command")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * * * * "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 表示每天的第一个小时执行一次 command")]),s._v("\n* "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * * * * "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 表示每天的第一个小时的第二分钟执行一次 command")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * * * "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v("\n")])])]),n("h2",{attrs:{id:"日志拷贝脚本-utils-copy-sh"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#日志拷贝脚本-utils-copy-sh"}},[s._v("#")]),s._v(" 日志拷贝脚本 utils/copy.sh")]),s._v(" "),n("p",[s._v("将 access.log 拷贝并重命名为 xxxx.access.log，清空 access.log 文件,继续积累日志")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/sh")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入到日志")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /Users/hanzhizhen/code-study/pro-blog-node/server/logs\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 拷贝 access.log 到 日期.access.log 文件中")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" access.log "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" +%Y-%m-%d"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(".access.log\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#清空 access.log")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" access.log\n\n")])])]),n("h2",{attrs:{id:"设置-crontab-命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#设置-crontab-命令"}},[s._v("#")]),s._v(" 设置 crontab 命令")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启设置 crontab 命令的文本输入界面")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("crontab")]),s._v(" -e\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在内部输入 crontab 的命令")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 比如：每天零点执行相关脚本，注意 sh 后面的 command 要写绝对路径")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 比如下面是当前电脑脚本位置")]),s._v("\n* "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" * * * "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" /Users/hanzhizhen/code-study/pro-blog-node/server/utils/copy.sh\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存成功后会提醒")]),s._v("\ncrontab: installing new "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("crontab")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询已设置指令")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("crontab")]),s._v(" -l\n")])])]),n("h2",{attrs:{id:"当前目录结构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#当前目录结构"}},[s._v("#")]),s._v(" 当前目录结构")]),s._v(" "),n("div",{staticClass:"language-txt extra-class"},[n("div",{staticClass:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("pre",{pre:!0,attrs:{class:"language-txt"}},[n("code",[s._v("  .\n  ├── bin  // 脚本目录\n  │   └── www.js // 启动 http 服务的脚本\n  ├── frontend // 前端项目\n  ├── package.json\n  ├── server\n  │   ├── app.js // 业务入口文件\n  │   ├── config\n  │   │   └── mysql.js // mysql 配置文件\n  │   │   └── redis.js // redis 配置文件\n  │   ├── controller\n  │   │   ├── blog.js // 博客数据处理\n  │   │   └── user.js // 用户数据处理\n  │   ├── db\n  │   │   └── mysql.js // mysql 数据库\n  │   │   └── redis.js // redis 数据存储\n  │   ├── logs\n  │   │   ├── 2022-01-09.access.log // [新增]测试脚本时生成的\n  │   │   ├── access.log // 访问日志\n  │   │   ├── error.log  // 错误日志\n  │   │   └── event.log  // 自定义事件日志\n  ├── model\n  │   │   └── resModel.js // 数据模型\n  │   ├── router\n  │   │   ├── blog.js  // 博客路由\n  │   │   ├── index.js\n  │   │   └── user.js // 用户路由\n  │   └── utils  // 公共方法\n  │       ├── copy.sh  // [新增] 日志拆分脚本\n  │       ├── cryp.js // 密码加密方法\n  │       ├── getCookie.js    // 处理 cookie 值\n  │       ├── getPostData.js  // 处理 post 数据\n  │       ├── getQueryData.js // 处理 get 数据\n  │       ├── log.js // 写日志\n  │       └── setCookieExpires.js // 设置 cookie 的过期时间\n  └── yarn.lock\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);